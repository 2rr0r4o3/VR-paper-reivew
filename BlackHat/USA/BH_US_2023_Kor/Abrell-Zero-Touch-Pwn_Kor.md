# Zero-Touch-Pwn: Abusing Zoom's Zero Touch Provisioning for Remote Attacks on Desk Phones

Introduction
저자는 SySS GmbH의 Senior IT Security Consultant인 Moritz Abrell이다. 이 연구는 Zoom의 Zero Touch Provisioning(ZTP) 기능을 악용하여 데스크폰에서 원격 공격을 수행하는 방법을 분석하였다. 연구의 목표는 ZTP를 통한 원격 공격의 가능성을 입증하고, 이에 대한 방어책을 제안하는 것이다.

Motivation
전통적인 엔드포인트 프로비저닝은 다양한 보안 취약점을 가지고 있다. 주요 취약점으로는 다음이 있다:

민감한 정보 접근성: 프로비저닝 과정에서 인증이 불충분하여 민감한 정보에 접근할 수 있다.
전송 암호화 부족: 데이터 전송 시 암호화되지 않아 중간에서 데이터를 가로챌 수 있다.
서버/클라이언트 검증 부족: 서버와 클라이언트를 상호 검증하지 않아 신뢰할 수 없는 연결이 가능하다.
클라우드 통신 서비스와의 결합: 전통적인 디바이스를 클라우드 서비스와 결합하면 보안 위협이 증가한다. 이는 공격자가 원격에서 장치를 제어할 수 있는 가능성을 높인다.

Why Zoom?
Zoom은 다양한 디바이스와의 호환성을 제공하며, Zoom Phone이라는 서비스로 인해 데스크폰과의 통합이 용이하다. 이 연구에서는 AudioCodes C450HD IP-Phone을 대상으로 한다. 이 전화기는 ZTP를 지원하며, 펌웨어가 공개적으로 다운로드 가능하다. Zoom의 ZTP는 관리자 개입 없이 전화기를 자동으로 프로비저닝할 수 있어 편리하지만, 보안 취약점이 존재할 수 있다.

Hardware
연구에서는 AudioCodes C450HD IP-Phone을 분석하였다. 주요 특징은 다음과 같다:

공개적으로 다운로드 가능한 펌웨어: 전화기의 펌웨어는 누구나 다운로드할 수 있어, 공격자가 이를 분석하고 악용할 수 있다.
ZTP 지원: 전화기는 ZTP를 지원하여 원격으로 설정을 자동화할 수 있다. 이는 초기 설정 시 특정 URL로 리다이렉트되어 설정 정보를 받아오는 과정을 포함한다.

Vendor Redirect Service
공급 업체 리다이렉트 서비스는 전화기가 초기 설정 시 특정 URL로 리다이렉트되어 설정 정보를 받아오는 방식이다. 이 과정에서 다음과 같은 취약점이 발생할 수 있다:

민감한 정보 노출: 설정 정보가 암호화되지 않은 상태로 전송되면 공격자가 이를 가로챌 수 있다.
인증 부족: 서버와 클라이언트 간의 상호 인증이 부족하여, 공격자가 중간에 개입할 수 있다.

Password Encryption
전화기의 펌웨어를 분석한 결과, 다음과 같은 라이브러리에서 암호화 함수가 사용되고 있음을 발견하였다:

/lib/libac_des3.so: AC_Decrypt_Param과 decrypt_string 함수 포함
/lib/libcgi.so
/lib/libdevice_management.so
/lib/libaq201.so
/home/ipphone/bin/voip_task_SFB
/home/ipphone/bin/nxphone
/home/ipphone/bin/emsc
/home/ipphone/bin/http_services
이 함수들은 DES_ede3_cbc_encrypt 방식을 사용하여 암호화를 수행한다. DES_ede3_cbc_encrypt는 3중 DES 방식으로 데이터를 암호화하며, 고정된 IV와 키를 사용하는 방식이다. 이 방식은 보안성이 낮아 쉽게 해독될 수 있다.

Vulnerabilities
다음은 연구에서 발견한 주요 취약점들이다:

SYSS-2022-052 (CVE-2023-22957): 하드코딩된 암호화 키 사용 (CWE-321). 공격자는 하드코딩된 키를 이용해 암호화된 데이터를 쉽게 해독할 수 있다.
SYSS-2022-053: 민감한 정보의 노출 (CWE-200). 프로비저닝 과정에서 민감한 정보가 암호화되지 않은 상태로 전송되어 공격자가 이를 가로챌 수 있다.
SYSS-2022-054 (CVE-2023-22956): 하드코딩된 암호화 키 사용 (CWE-321). 동일한 취약점으로, 암호화 키가 코드에 하드코딩되어 있어 보안성이 낮다.
SYSS-2022-055 (CVE-2023-22955): 하드웨어의 불변 루트 오브 트러스트 없음 (CWE-1326). 펌웨어가 서명되지 않아 공격자가 악성 펌웨어로 교체할 수 있다.
SYSS-2022-056: 소유권 확인되지 않음 (CWE-283). 디바이스의 소유권이 제대로 확인되지 않아, 공격자가 디바이스를 임의로 제어할 수 있다.

Exploitation
공격자는 다음과 같은 방법으로 취약점을 악용할 수 있다:

하드코딩된 암호화 키를 이용한 공격: 공격자는 하드코딩된 암호화 키를 이용해 암호화된 설정 파일을 해독하고, 민감한 정보를 탈취하거나 설정을 변조할 수 있다.
리다이렉트 서비스 악용: 공격자는 전화기가 잘못된 설정 정보를 받아오도록 리다이렉트 서비스를 조작할 수 있다.
펌웨어 분석: 공개적으로 다운로드 가능한 펌웨어를 분석하여, 취약한 라이브러리를 통해 악성 코드를 실행할 수 있다.

Recommendations
연구에서는 다음과 같은 보안 조치를 권고한다:
리다이렉션 검토: 리다이렉션 URL의 신뢰성을 검토하고, 불필요한 리다이렉션을 제한한다.
네트워크 통신 제한: 전화기의 네트워크 통신을 제한하여 외부 공격의 가능성을 줄인다.
암호화 강화: 고정된 암호화 키 대신, 동적으로 생성된 키를 사용하고, 전송되는 모든 데이터를 암호화한다.
펌웨어 서명: 펌웨어에 디지털 서명을 추가하여, 신뢰할 수 없는 펌웨어가 설치되지 않도록 한다.

Conclusion
이 연구는 Zoom의 ZTP를 악용하여 데스크폰에서 원격 공격을 수행할 수 있는 취약점을 상세히 분석하였다. 주요 취약점은 하드코딩된 암호화 키, 불변 루트 오브 트러스트의 부재, 소유권 확인되지 않음 등이다. 이러한 취약점들은 공격자가 원격으로 전화기의 설정을 변조하거나 민감한 정보를 탈취하는 등의 공격을 가능하게 한다. 연구에서는 이러한 문제를 해결하기 위한 보안 조치를 제안하고, 공급 업체가 이를 통해 보안성을 강화할 것을 권고한다.
